Bootstrap: docker
From: python:3.10-slim-bookworm

%environment
  export PATH=/root/.local/bin:$PATH

%files
  . /app

%post
  # install global dependencies
  apt-get update
  apt-get install --no-install-recommends curl ca-certificates git ffmpeg -y
  apt-get clean && rm -rf /var/lib/apt/lists/*

  # install UV
  curl -LsSf https://astral.sh/uv/0.7.8/install.sh -o /uv-installer.sh
  sh /uv-installer.sh && rm /uv-installer.sh
  export PATH=/root/.local/bin:$PATH

  # install local dependencies
  cd /app
  uv sync --locked

%runscript
  cd /app
  uv run main.py pipeline

%labels
  Author k.a.gibb@sussex.ac.uk, nrs23@sussex.ac.uk, david.kadish@mau.se
  Version v1.0.0
