Bootstrap: localimage
From: soundade-environment.sif

%environment
  export CODE_PATH=/code
  export DATA_PATH=/data
  export PROFILE_PATH=$DATA_PATH/run-environment/profile
  export GIT_COMMIT=$(git rev-parse HEAD)

%files
  ./pyproject.toml /code/pyproject.toml
  ./src /code/src
  ./scripts/process_files.py /code/scripts/process_files.py
  ./pipeline-steps.sh /code/pipeline-steps.sh
  ./README.md /code/README.md

%post
  opt/conda/bin/conda run -n soundade python -m pip install /code

%runscript
  bash /code/pipeline-steps.sh

%labels
  Author nrs23@sussex.ac.uk, david.kadish@mau.se
  Version v0.0.1